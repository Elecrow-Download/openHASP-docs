<h1>Waveshare RPi LCD (Rev C)</h1>

<div class="row justify-content-center">
        <a href="https://www.waveshare.com/media/catalog/product/cache/1/image/800x800/9df78eab33525d08d6e5fb8d27136e95/4/r/4rcp-fs.jpg" data-toggle="lightbox" data-gallery="example-gallery" class="col-sm-4" data-title="WaveShare 4.0&quot; RPi LCD (Rev C)" data-footer="Copyright © 2021, Waveshare, All Rights Reserved - Permission Pending">
            <img src="https://www.waveshare.com/media/catalog/product/cache/1/image/800x800/9df78eab33525d08d6e5fb8d27136e95/4/r/4rcp-fs.jpg" class="img-fluid">
        </a>
        <a href="https://www.waveshare.com/media/catalog/product/cache/1/image/800x800/9df78eab33525d08d6e5fb8d27136e95/4/r/4rcp-bs2.jpg" data-toggle="lightbox" data-gallery="example-gallery" class="col-sm-4" data-title="WaveShare 4.0&quot; RPi LCD (Rev C)" data-footer="Copyright © 2021, Waveshare, All Rights Reserved - Permission Pending">
            <img src="https://www.waveshare.com/media/catalog/product/cache/1/image/800x800/9df78eab33525d08d6e5fb8d27136e95/4/r/4rcp-bs2.jpg" class="img-fluid">
        </a>
</div>

## Models

The Waveshare RPi LCD (Rev C) display comes in 3.5" and 4.0" sizes:

{!assets/buy/waveshare-rpi-lcd-table.html!}



## Backlight Control

By default the display is always on. To enable backlight dimming, you can connect the pads marked by the red arrow using a 0R resistor or a direct solder connection:

<div class="row justify-content-center">
    <a href="https://www.waveshare.com/w/upload/1/17/3.5inch-RPi-LCD-C-Manual-01.jpg" data-toggle="lightbox" data-gallery="example-gallery" class="col-sm-6" data-title="WaveShare 3.5&quot; RPi LCD (Rev C)" data-footer="Copyright © 2021, Waveshare, All Rights Reserved - Permission Pending">
        <img src="https://www.waveshare.com/w/upload/1/17/3.5inch-RPi-LCD-C-Manual-01.jpg" class="img-fluid">
    </a>
</div>

!!! warning "Attention (*)"
    The WaveShare 3.5" RPi LCD **Revision C** (SKU 15811) and WaveShare 4.0" RPi LCD **Revision C** (SKU 16099) have the solder jumper on the back to enable PWM backlight dimming.
    Most revisions of this board do not have this feature!


## Development Boards

### ESP32 One

The Waveshare ESP32 One development board has the same form factor as the Raspberry Pi Zero, inluding a 40 pin GPIO header.
The ESP32 One is plug-and-play compatible with the Waveshare RPi LCD (Rev C) 3.5" and 4".

<div class="row justify-content-center">
        <a href="https://www.waveshare.com/media/catalog/product/cache/1/image/800x800/9df78eab33525d08d6e5fb8d27136e95/e/s/esp32-one-kit-1.jpg" data-toggle="lightbox" data-gallery="example-gallery" class="col-sm-4" data-title="WaveShare ESP32 One" data-footer="Copyright © 2021, Waveshare, All Rights Reserved - Permission Pending">
            <img src="https://www.waveshare.com/media/catalog/product/cache/1/image/800x800/9df78eab33525d08d6e5fb8d27136e95/e/s/esp32-one-kit-1.jpg" class="img-fluid">
        </a>
        <a href="https://www.waveshare.com/img/devkit/accBoard/ESP32-One/ESP32-One-details-1.jpg" data-toggle="lightbox" data-gallery="example-gallery" class="col-sm-4" data-title="WaveShare ESP32 One" data-footer="Copyright © 2021, Waveshare, All Rights Reserved - Permission Pending">
            <img src="https://www.waveshare.com/img/devkit/accBoard/ESP32-One/ESP32-One-details-1.jpg" class="img-fluid">
        </a>
</div>

<div class="dropdown show">
    <a class="md-button md-button--primary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span class="twemoji"><svg
                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path
                    d="M19 20c0 1.11-.89 2-2 2a2 2 0 0 1-2-2c0-1.11.89-2 2-2a2 2 0 0 1 2 2M7 18c-1.11 0-2 .89-2 2a2 2 0 0 0 2 2c1.11 0 2-.89 2-2s-.89-2-2-2m.2-3.37-.03.12c0 .14.11.25.25.25H19v2H7a2 2 0 0 1-2-2c0-.35.09-.68.24-.96l1.36-2.45L3 4H1V2h3.27l.94 2H20c.55 0 1 .45 1 1 0 .17-.05.34-.12.5l-3.58 6.47c-.34.61-1 1.03-1.75 1.03H8.1l-.9 1.63M8.5 11H10V9H7.56l.94 2M11 9v2h3V9h-3m3-1V6h-3v2h3m3.11 1H15v2h1l1.11-2m1.67-3H15v2h2.67l1.11-2M6.14 6l.94 2H10V6H6.14z">
                </path>
            </svg></span> Buy </a>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <a class="dropdown-item md-typeset__table" href="https://www.amazon.com/dp/B08TBB2R2G/">Amazon US</a>
        <a class="dropdown-item md-typeset__table" href="https://www.amazon.co.uk/dp/B08TBB2R2G/">Amazon UK</a>
        <a class="dropdown-item md-typeset__table" href="https://www.amazon.de/dp/B08TBB2R2G/">Amazon DE</a>
        <a class="dropdown-item md-typeset__table" href="https://www.amazon.fr/dp/B08TBB2R2G/">Amazon FR</a>
        <a class="dropdown-item md-typeset__table" href="https://www.amazon.es/dp/B08TBB2R2G/">Amazon ES</a>
        <a class="dropdown-item md-typeset__table" href="https://www.amazon.nl/dp/B08TBB2R2G/">Amazon NL</a>
    <div class="dropdown-divider"></div>
        <a class="dropdown-item md-typeset__table" href="https://www.aliexpress.com/item/1005002055975943.html">AliExpress</a>
        <a class="dropdown-item md-typeset__table" href="https://www.waveshare.com/esp32-one.htm">Waveshare.com</a>
    </div>
</div>

#### Pinout

<a href="https://www.waveshare.com/img/devkit/accBoard/ESP32-One/ESP32-One-details-inter.jpg" data-toggle="lightbox" data-gallery="example-gallery" class="col-sm-4" data-title="WaveShare ESP32 One Pinout" data-footer="Copyright © 2021, Waveshare, All Rights Reserved - Permission Pending">
    <img src="https://www.waveshare.com/img/devkit/accBoard/ESP32-One/ESP32-One-details-inter.jpg" class="img-fluid">
</a>

## Pin Configuration

LCD Pin |Function          |ESP32 Pin  |Config Name|Display Pin |
------|--------------------|-----------|-----------|------------|
1     |Module Power 3.3V   |3.3V       |           |3.3V
2     |Module Power 5v     |5V         |           |5V
3     | Not connected      |           |           |NC
4     |                    |           |           |5V
5-10  | Not connected      |           |           |NC
11    | Touch Interrupt    |NC         |           |TP_IRQ
12 (*)| LED Backlight PWM  |GPIO26     |TFT_BCKL   |LCD_LED
13    | Not connected      |           |           |NC
14    |Module Ground       |GND        |           |GND
15-16 | Not connected      |           |           |NC
17    |Module Power        |3.3V       |           |3.3V
18    |Data Command control pin|GPIO4  |TFT_DC     |LCD_RS
19    |SPI Master Out Slave In |GPIO13 |TFT_MOSI   |LCD/SI/TP_SI
20    |Not connected       |           |           |NC
21    |Touch Panel Slave Out|GPIO12    |TFT_MISO   |TP_SO
22    |LCD Reset pin       |GPIO32     |TFT_RST    |RST
23    |SPI Clock           |GPIO14     |TFT_SCLK   |LCD_SCK/TP_SCK
24    |Chip select control pin|GPIO5   |TFT_CS     |LCD_CS
25    |Module Ground	   |GND        |           |GND
26    |Touch Chip Select   |GPIO22     |TOUCH_CS   |TP_CS

SPI MISO, MOSI and SCLK are shared between the touch controller and the LCD controller.

You can also use jumper wires to connect the display to any ESP32 development board:

6 GPIOs are required to drive the SPI display. One additional GPIO is needed for the XPT2046 touch sensor and one extra GPIO for backlight dimming.
Including the VCC and GND pins, a total of 13 connections need to be made to the MCU.


## LCD Configuration

The `lcd_config.ini` file specifies the different properties of the display, except for the actual pin configuration:

```ini
raspberrypi =
    -D RPI_DISPLAY_TYPE=1
    -D ST7796_DRIVER=1
    -D TFT_WIDTH=320
    -D TFT_HEIGHT=480
    -D TFT_ROTATION=0 ; 0=0, 1=90, 2=180 or 3=270 degree
    -D SPI_FREQUENCY=80000000
    -D SPI_TOUCH_FREQUENCY=2500000
    -D USER_SETUP_LOADED=1
    -D TOUCH_DRIVER=2046 ; XPT2046 Resistive touch panel driver
    -D SUPPORT_TRANSACTIONS
```

## HASP build_flags

Specify the LCD Configuration to use and define the 7 GPIOs in the environment build flags:

```ini
build_flags =
    ${env.build_flags}
    ${esp32.build_flags}
    -DBOARD_HAS_PSRAM               ; uses 78kB
    
; -- TFT_eSPI build options ------------------------
    ${lcd.raspberrypi}
    ${esp32.hspi}        ; Use HSPI hardware SPI bus
    -D TFT_CS=5
    -D TFT_DC=4
    -D TFT_RST=32
    -D TFT_BCKL=26       ; Default, configurable via web UI
    -D TOUCH_CS=22
    -D SD_CS=15          ; Currently not supported
```

[1]: https://www.waveshare.com/4inch-rpi-lcd-c.htm
[2]: https://www.aliexpress.com/item/32976207190.html
[3]: https://www.waveshare.com/3.5inch-rpi-lcd-c.htm